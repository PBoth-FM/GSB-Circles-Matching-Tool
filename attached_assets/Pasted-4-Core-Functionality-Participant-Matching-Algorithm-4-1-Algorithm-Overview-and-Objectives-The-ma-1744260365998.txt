4. Core Functionality: Participant Matching Algorithm
4.1 Algorithm Overview and Objectives
The matching algorithm is designed to:
Maximize the total number of participants matched
Honor participants' preferences while satisfying system constraints

4.2 Algorithm Constraints
4.2.1 Circle Size Constraints
New Circles:
Minimum size: 5 participants
Maximum size: 10 participants
Continuing Circles:
Minimum size: 5 participants
Maximum size: Determined by:
If any continuing member specified a co_leader_max_new_members value of "None", no new members will be added
If multiple continuing members provided different values for co_leader_max_new_members, use the smallest non-null value (Again if anyone responded “None” then do not add any new members)
Maximum = current circle size + selected co_leader_max_new_members value
If no continuing member specified a value, default to 10 participants total
4.2.2 Host Requirements
In-person circles must have either:
At least one participant with host=”Always”, OR
At least two participants with host=“Sometimes”
Virtual circles have no host requirements
4.2.3 Time Compatibility Requirements
Time compatibility is determined as a binary yes/no:
Direct matches are fully compatible (e.g., "Monday (Evenings)" with "Monday (Evenings)")
Day ranges are compatible with any individual day they contain. E.g., “Monday-Thursday (Evenings)” matches with “Tuesday (Evenings)”, “Wednesday (Evenings)”, etc. It does NOT match with “Tuesday (Day)”
Circles with "Varies" day are compatible with ANY day preference, as long as time period is also compatible.
Circles with "Varies" time period are compatible with any time period (as long as day is also compatible)
If day is compatible but time period is not, the combination is not compatible

See Figure 1 for Table compatibility matrix

4.2.4 Location Compatibility Requirements
Virtual preferences are compatible with corresponding timezone
In-person preferences require exact subregion match

4.3 Matching Process
4.3.1 Existing Circle Continuation
Participants with status "Current-CONTINUING" are initially assigned to their current circle
An existing circle is maintained if:
It has at least 2 members with status "Current-CONTINUING"
For in-person circles, it meets host requirements
Members of non-viable circles are moved to the general matching pool with:
Format preference derived from circle ID prefix
First choice location set to their current_subregion
First choice day/time set to their current meeting schedule
4.3.2 Regional Processing
Participants are grouped by derived region
For "CURRENT-Continuing" participants, use current_region
For all others, use requested_region_from_form
Each regional group is processed independently, including virtual regions
4.3.3 Small Circle Prioritization
Within each region, existing circles with 2-4 members are identified
The algorithm calculates all possible configurations that:
Meet all matching requirements
Satisfy all circle constraints
Each scenario receives a score based on:
1,000 points per matched participant (primary objective)
Additional points for preference satisfaction (up to 6 points per participant)
The algorithm selects the scenario with the highest total score
Small circles that cannot reach 5 members have all members returned to the general pool
4.3.4 Global Optimization
For each region, the algorithm processes to-be-matched participants
The algorithm calculates all possible configurations that:
Meet all matching requirements
Satisfy all circle constraints
Each scenario receives a score based on:
1,000 points per matched participant (primary objective)
Additional points for preference satisfaction (up to 6 points per participant, see section 4.4 below)
The algorithm selects the scenario with the highest total score

4.4 Preference Scoring System
4.4.1 Location Preference Scoring
3 points for first choice location match
2 points for second choice location match
1 point for third choice location match
4.4.2 Time Preference Scoring
3 points for first choice day/time match
2 points for second choice day/time match
1 point for third choice day/time match

4.5 Circle Creation and Naming 
For each region, select the optimization scenario with the highest total score (i.e., the maximum number of matched participants and, among options where there are multiple solutions, the best preference score). These are the proposed circles
Naming:
Existing circles retain their original IDs
New in-person circles: IP-NEW-XXX-NN
New virtual circles: VI-NEW-XX-NN
Where:
IP = In-person, VI = Virtual
NEW indicates a newly created circle
XXX = Region code (e.g., ATL for Atlanta)
XX = Two-letter region code for virtual circles (e.g., AM for Americas)
NN = Sequential number starting from 01 for this region

Example for the South Florida region, which has 14 participants.
I will show two scenarios, but the optimizer should generate ALL possible combinations with these participants for this region and compare their scores to identify the best solution. 

Scenario 1: Final optimizer score 13,063
Scenario 2: Final optimizer score 11,048
Conclusion: Scenario 1 should be chosen, since 13,063>11,048
